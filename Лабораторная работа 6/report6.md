---
## Front matter
lang: ru-RU
title: Лабораторная работа №6
author: Абушек Дмитрий Олегович
institute: 2023, Москва
date: НФИбд-01-20


## Formatting
toc: false
slide_level: 2
theme: metropolis
header-includes: 
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
 - '\makeatletter'
 - '\beamer@ignorenonframefalse'
 - '\makeatother'
aspectratio: 43
section-titles: true
---

- Изучить и построить модель эпидемии

## Теоретическое введение. Построение математической модели (1)

Рассмотрим простейшую модель эпидемии. Предположим, что некая популяция, состоящая из $N$ особей, (считаем, что популяция изолирована) подразделяется на три группы. Первая группа - это восприимчивые к болезни, но пока здоровые особи, обозначим их через $S(t)$. Вторая группа – это число инфицированных особей, которые также при этом являются распространителями инфекции, обозначим их $I(t)$. А третья группа, обозначающаяся через $R(t)$ – это здоровые особи с иммунитетом к болезни. 

До того, как число заболевших не превышает критического значения $I^*$, считаем, что все больные изолированы и не заражают здоровых. Когда $I(t)> I^*$, тогда инфицирование способны заражать восприимчивых к болезни особей. 

## Теоретическое введение. Построение математической модели (2)

Таким образом, скорость изменения числа $S(t)$ меняется по следующему закону:



## Теоретическое введение. Построение математической модели (3)

Поскольку каждая восприимчивая к болезни особь, которая, в конце концов, заболевает, сама становится инфекционной, то скорость изменения числа инфекционных особей представляет разность за единицу времени между заразившимися и теми, кто уже болеет и лечится, то есть:



## Теоретическое введение. Построение математической модели (4)

А скорость изменения выздоравливающих особей (при этом приобретающие иммунитет к болезни):

$$\frac{dR}{dt} = \beta I$$

Постоянные пропорциональности $\alpha, \beta$ - это коэффициенты заболеваемости и выздоровления соответственно. Для того, чтобы решения соответствующих уравнений определялось однозначно, необходимо задать начальные условия. Считаем, что на начало эпидемии в момент времени $t=0$ нет особей с иммунитетом к болезни $R(0)=0$, а число инфицированных и восприимчивых к болезни особей $I(0)$ и $S(0)$ соответственно. Для анализа картины протекания эпидемии необходимо рассмотреть два случая:  $I(0) \leq I^*$ и  $I(0)>I^*$

## Задание лабораторной работы. Вариант 1

На одном острове вспыхнула эпидемия. Известно, что из всех проживающих на острове 
$(N=20000)$ в момент начала эпидемии $(t=0)$ число заболевших людей 
(являющихся распространителями инфекции) $I(0)=99$, А число здоровых людей с иммунитетом 
к болезни $R(0)=5$. Таким образом, число людей восприимчивых к болезни, 
но пока здоровых, в начальный момент времени $S(0)=N-I(0)-R(0)$.
Постройте графики изменения числа особей в каждой из трех групп.

Рассмотрите, как будет протекать эпидемия в случае:

1.	$I(0)\leq I^*$

2.	$I(0)>I^*$

## Задачи:

Построить графики изменения числа особей в каждой из трех групп $S$, $I$, $R$. Рассмотреть, как будет протекать эпидемия в случаях:

1.	$I(0)\leq I^*$

2.	$I(0)>I^*$

# Ход выполнения лабораторной работы

## Математическая модель

По представленному выше теоретическому материалу были составлены модели на обоих языках программирования.

# Решение с помощью программ
# Код
Julia 
```
using Plots
using DifferentialEquations

N = 20000
I0 = 88 # заболевшие особи
R0 = 5 # особи с иммунитетом
S0 = N - I0 - R0 # здоровые, но восприимчивые особи

alpha = 0.6 # коэффициент заболеваемости
beta = 0.2 # коэффициент выздоровления


#I0 <= I*
function ode_fn(du, u, p, t)
    S, I, R = u
    du[1] = 0
    du[2] = -beta*u[2]
    du[3] = beta*I
end

v0 = [S0, I0, R0]
tspan = (0.0, 60.0)
prob = ODEProblem(ode_fn, v0, tspan)
sol = solve(prob, dtmax = 0.05)
S = [u[1] for u in sol.u]
I = [u[2] for u in sol.u]
R = [u[3] for u in sol.u]
T = [t for t in sol.t]
plt = plot(
  dpi = 600,
  legend = :topright)
plot!(
  plt,
  T,
  S,
  label = "Восприимчивые особи",
  color = :blue)
plot!(
  plt,
  T,
  I,
  label = "Инфицированные особи",
  color = :green)
plot!(
  plt,
  T,
  R,
  label = "Особи с иммунитетом",
  color = :red)

savefig(plt, "lab06_1.png")

```
```
using Plots
using DifferentialEquations

N = 20000
I0 = 99 # заболевшие особи
R0 = 5 # особи с иммунитетом
S0 = N - I0 - R0 # здоровые, но восприимчивые особи

alpha = 0.4 # коэффициент заболеваемости
beta = 0.1 # коэффициент выздоровления


#I0 > I*
function ode_fn(du, u, p, t)
    S, I, R = u
    du[1] = -alpha*u[1]
    du[2] = alpha*u[1] - beta*u[2]
    du[3] = beta*I
end

v0 = [S0, I0, R0]
tspan = (0.0, 120.0)
prob = ODEProblem(ode_fn, v0, tspan)
sol = solve(prob, dtmax=0.05)
S = [u[1] for u in sol.u]
I = [u[2] for u in sol.u]
R = [u[3] for u in sol.u]
T = [t for t in sol.t]

plt = plot(
  dpi=600,
  legend=:right)

plot!(
  plt,
  T,
  S,
  label="Восприимчивые особи",
  color=:blue)
plot!(
  plt,
  T,
  I,
  label="Инфицированные особи",
  color=:green)
plot!(
  plt,
  T,
  R,
  label="Особи с иммунитетом",
  color=:red)


savefig(plt, "lab06_2.png")

```
OpenModelica
```
model lab61

Real N = 20000;
Real I;
Real R;
Real S;
Real alpha = 0.6;
Real beta = 0.2;
initial equation
I = 99;
R = 5;
S = N - I - R;
equation
der(S) = 0;
der(I) = -beta*I;
der(R) = beta*I;

end lab61;
```
```
model lab62

Real N = 20000;
Real I;
Real R;
Real S;
Real alpha = 0.4;
Real beta = 0.1;
initial equation
I = 99;
R = 5;
S = N - I - R;
equation
der(S) = -alpha*S;
der(I) = alpha*S - beta*I;
der(R) = beta*I;


end lab62;
```

## Результаты работы кода на Julia и Open Modelica для случая $I(0) \leq I^*$ 
(графики численности особей трех групп $S$, $I$, $R$, когда больные изолированы)



!["График, построенный на языке Julia"](https://github.com/dmitryabushek/study_2022-2023__matmod/blob/master/Лабораторная%20работа%206/images/lab06_1.png){#fig:001}



!["График, построенный на языке Open Modelica"]()



## Результаты работы кода на Julia и Open Modelica для случая $I(0) \leq I^*$ 
(графики численности особей трех групп $S$, $I$, $R$, когда больные могут заражать особей группы $S$)



!["График, построенный на языке Julia"]()



!["График, построенный на языке Open Modelica"]()



## Анализ полученных результатов. Сравнение языков.

- В итоге проделанной работы мы построили графики зависимости численности особей трех групп S, I, R для случаев, когда больные изолированы и когда они могут заражать особей группы S.

- Построение модели эпидемии на языке OpenModelica занимает значительно меньше строк, чем аналогичное построение на Julia. Кроме того, построения на языке OpenModelica проводятся относительно значения времени t по умолчанию, что упрощает нашу работу.

# Вывод

## Вывод

В ходе выполнения лабораторной работы была изучена модель эпидемии и построена модель на языках Julia и Open Modelica.

## Список литературы. Библиография

 [1] Документация по Julia: https://docs.julialang.org/en/v1/

 [2] Документация по OpenModelica: https://openmodelica.org/

 [3] Решение дифференциальных уравнений: https://www.wolframalpha.com/

 [4] Конструирование эпидемиологических моделей: https://habr.com/ru/post/551682/
